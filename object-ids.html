<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.1 from src/site/markdown/object-ids.md at 2020-01-13
 | Rendered using Apache Maven Fluido Skin 1.8
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.1" />
    <title>MongoDB Jackson Mapper &#x2013; Using Object IDs</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.8.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.8.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/mongojack/mongojack">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
        alt="Fork me on GitHub">
    </a>
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><a href="./" id="bannerLeft"><h2>MongoJack</h2>
</a></div>
          <div class="pull-right"><div id="bannerRight"><img src="images/mongodb-leaf.png"  alt=""/></div>
</div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2020-01-13<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 3.0.0-SNAPSHOT</li>
      <li class="pull-right"><span class="divider">|</span>
<a href="http://maven.apache.org/" class="externalLink" title="Maven 3">Maven 3</a></li>
      <li class="pull-right"><a href="http://www.apache.org/" class="externalLink" title="Apache">Apache</a></li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li><a href="index.html" title="About"><span class="none"></span>About</a></li>
    <li><a href="installation.html" title="Installation"><span class="none"></span>Installation</a></li>
    <li><a href="tutorial.html" title="Tutorial"><span class="none"></span>Tutorial</a></li>
    <li><a href="changelog.html" title="Changelog"><span class="none"></span>Changelog</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-right"></span>Project Information</a></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
            <hr />
            <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<h1>Using Object IDs</h1>
<p>The simplest way to use ObjectId elements, both for document IDs and also for references to other documents (or anything) is to declare the field to have a type of org.bson.types.ObjectId. MongoJack will handle serialisation/deserialisation of these with no problems.  If you name the ID field &#x201c;_id&#x201d;, no extra configuration is required.  If you want to name the primary ID field something else, you will need to annotate it with javax.persistence.Id.</p>
<p>However, there are some use cases where you may not want to use the ObjectId type, for example, if the same objects get serialised to the web, or if you just prefer dealing with more basic types. MongoJack provides <i>some</i> support for this, though there are a few areas that you need to be careful about.</p><section>
<h2><a name="Other_Types"></a>Other Types</h2>
<p>If you declare your &#x201c;_id&#x201d; field (or a field annotated with @javax.persistence.Id) to have any supported type (e.g. String, or Long), and generate or fill out the field value yourself, MongoJack will generally save and retrieve the values adequately; it wont&#x2019; use the built-in org.bson.types.ObjectId, but a Long or String id generated in some other way in the Java code should be perfectly valid.</p>
<p>If you declare your &#x201c;_id&#x201d; of type String, Mongo&#x2019;s insert methods will generate an object-id value for the field, but it will be saved as a String, not an ObjectId, which probably isn&#x2019;t what you want.</p></section><section>
<h2><a name="a.40ObjectId"></a>@ObjectId</h2>
<p>The @org.mongojack.ObjectId annotation can be added to any String or byte[] field to indicate that you want its value to be stored as an ObjectId. It can also be added to org.mongojack.DBRef fields who&#x2019;s ID type paramater is String or byte[], as well as collection/array fields and Map fields. This annotation instructs MongoJack to serialise the given value into an ObjectId, and deserialise any encountered ObjectIds into the type of the field.  The following are all valid uses:</p>

<div>
<div>
<pre class="source">public class MyClass {
    @ObjectId
    public String _id;
    @ObjectId
    public byte[] someArbitraryId;
    @ObjectId
    public List&lt;String&gt; arbitraryCollectionOfIds;
    @ObjectId
    public DBRef&lt;AnotherClass, byte[]&gt; anotherObject;
    @ObjectId
    public List&lt;DBRef&lt;AnnotherClass, String&gt; collectionOfOtherObjects;
    @ObjectId
    public Map&lt;String, String&gt; mapOfStringsToObjectIds;
}
</pre></div></div>

<p>What is not currently supported is multi dimensional arrays/collections.  Serialising map keys to ObjectIds are naturally not supported because MongoDB does not support ObjectIds as key values.</p>
<p>If using getters and setters, the annotation must be added to <i>both</i> the getter and the setter, for example:</p>

<div>
<div>
<pre class="source">public class MyClass {
    private String someId;
    @ObjectId
    public String getSomeId() {
        return someId;
    }
    @ObjectId
    public void setSomeId(String someId) {
        this.someId = someId;
    }
}
</pre></div></div>

<p>If using property based @JsonCreator methods, then it must be added to the parameter:</p>

<div>
<div>
<pre class="source">public class MyClass {
    private final String someId;
    @JsonCreator
    public MyClass(@ObjectId @JsonProperty(&quot;someId&quot;) someId) {
        this.someId = someId;
    }
    @ObjectId
    public String getSomeId() {
        return someId;
    }
}
</pre></div></div>

<p>If using custom (de)serialisers or delegate @JsonCreator methods, then you will need to handle the ObjectIds yourself.</p>
<p>If the setter for the _id field of the object is annotated with @ObjectId, then the *ById() methods on JacksonMongoCollection will use serialise the passed in parameter to an ObjectId for you, and WriteResult.getSavedId() will deserialise it from ObjectId.  If using a custom deserialiser for the bean, this will not work, even if the getter for the property is annotated with @ObjectId.  This may be fixed in future, and is dependent on support from Jackson to give better information about configured serialisers.</p></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &#169;      2011&#x2013;2020<a href="http://www.devbliss.com">devbliss GmbH</a>.
.</p>
        </div>
      </div>
    </footer>
  </body>
</html>